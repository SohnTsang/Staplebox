{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}
{% load crispy_forms_filters %}

{% block title %}View Access{% endblock %}

{% block content %}
<div class="container">
    <h2>Access Granted To Me</h2>
    <div class="accordion" id="accordionExample">
        {% for product_id, product_info in products_structure.items %}
        <div class="accordion-item">
            <h2 class="accordion-header" id="heading{{ product_id }}">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ product_id }}" aria-expanded="false" aria-controls="collapse{{ product_id }}">
                    {{ product_info.name }} by {{ product_info.exporter }}
                </button>
            </h2>
            <div id="collapse{{ product_id }}" class="accordion-collapse collapse" aria-labelledby="heading{{ product_id }}" data-bs-parent="#accordionExample">
                <div class="accordion-body">
                    <!-- Content here -->
                    {% for folder_id, folder_info in product_info.folders.items %}
                        <div>{{ folder_info.name }}</div>
                        <!-- Include your subfolders template if necessary -->
                        {% if folder_info.subfolders %}
                            {% include 'access_control/subfolders.html' with folders=folder_info.subfolders %}
                        {% endif %}
                        {% for document_name in folder_info.documents %}
                            <li>{{ document_name }}</li>
                        {% endfor %}
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

{% block javascript %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}
{% endblock %}
